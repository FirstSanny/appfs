\hypertarget{classex2_1_1ParseXML}{}\section{ex2.\+Parse\+X\+ML Class Reference}
\label{classex2_1_1ParseXML}\index{ex2.\+Parse\+X\+ML@{ex2.\+Parse\+X\+ML}}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classex2_1_1ParseXML_a34388961dd25cf9813e954854a06bf89}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, xml, xsd, verbose)
\item 
def \hyperlink{classex2_1_1ParseXML_a4895e49c1059c9aedd93f97c29eee30f}{read\+X\+SD} (self)
\item 
def \hyperlink{classex2_1_1ParseXML_a5525ea8efb94c0fd12c9100b04702c5b}{read\+X\+ML} (self, schema=None)
\item 
def \hyperlink{classex2_1_1ParseXML_ad085ab1449b4ae5d51fef904d759c73b}{read\+Attributes} (self)
\item 
def \hyperlink{classex2_1_1ParseXML_a87b2265b8dccd79ff09bd10ee2f8c269}{write\+C\+SV} (self)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
{\bfseries file\+X\+ML}\hypertarget{classex2_1_1ParseXML_ae06baa8c594f88a71490e8bafae1da37}{}\label{classex2_1_1ParseXML_ae06baa8c594f88a71490e8bafae1da37}

\item 
{\bfseries file\+X\+SD}\hypertarget{classex2_1_1ParseXML_a6075f0d21a2b394e7d6413347967b61e}{}\label{classex2_1_1ParseXML_a6075f0d21a2b394e7d6413347967b61e}

\item 
{\bfseries verbose}\hypertarget{classex2_1_1ParseXML_a903303a97ffb911574f691744978e7e5}{}\label{classex2_1_1ParseXML_a903303a97ffb911574f691744978e7e5}

\item 
{\bfseries dict}\hypertarget{classex2_1_1ParseXML_a782928ec4f5e8e20237621fb7a9178b7}{}\label{classex2_1_1ParseXML_a782928ec4f5e8e20237621fb7a9178b7}

\item 
{\bfseries root\+X\+ML}\hypertarget{classex2_1_1ParseXML_aae05e41a6c40855aa4bc78a80ba1f2be}{}\label{classex2_1_1ParseXML_aae05e41a6c40855aa4bc78a80ba1f2be}

\item 
{\bfseries date}\hypertarget{classex2_1_1ParseXML_a83d9af9a8df0ff6091822bccc1d6c236}{}\label{classex2_1_1ParseXML_a83d9af9a8df0ff6091822bccc1d6c236}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}XML file handling.\end{DoxyVerb}
 

Definition at line 19 of file ex2.\+py.



\subsection{Constructor \& Destructor Documentation}
\index{ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+(self, xml, xsd, verbose)}{__init__(self, xml, xsd, verbose)}}]{\setlength{\rightskip}{0pt plus 5cm}def ex2.\+Parse\+X\+M\+L.\+\_\+\+\_\+init\+\_\+\+\_\+ (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{xml, }
\item[{}]{xsd, }
\item[{}]{verbose}
\end{DoxyParamCaption}
)}\hypertarget{classex2_1_1ParseXML_a34388961dd25cf9813e954854a06bf89}{}\label{classex2_1_1ParseXML_a34388961dd25cf9813e954854a06bf89}
\begin{DoxyVerb}Initiate the passed files and options.

Parameters
----------
xml : the xml file to extract the "amountOfPower" from
xsd : the schema file to validate the xml against
verbose : prompt some info on the screen
\end{DoxyVerb}
 

Definition at line 22 of file ex2.\+py.


\begin{DoxyCode}
22     \textcolor{keyword}{def }\hyperlink{classex2_1_1ParseXML_a34388961dd25cf9813e954854a06bf89}{\_\_init\_\_}(self, xml, xsd, verbose):
23         \textcolor{stringliteral}{"""}
24 \textcolor{stringliteral}{        Initiate the passed files and options.}
25 \textcolor{stringliteral}{}
26 \textcolor{stringliteral}{        Parameters}
27 \textcolor{stringliteral}{        ----------}
28 \textcolor{stringliteral}{        xml : the xml file to extract the "amountOfPower" from}
29 \textcolor{stringliteral}{        xsd : the schema file to validate the xml against}
30 \textcolor{stringliteral}{        verbose : prompt some info on the screen}
31 \textcolor{stringliteral}{        """}
32         self.\hyperlink{classex2_1_1ParseXML_ae06baa8c594f88a71490e8bafae1da37}{fileXML} = xml
33         self.\hyperlink{classex2_1_1ParseXML_a6075f0d21a2b394e7d6413347967b61e}{fileXSD} = xsd
34         self.\hyperlink{classex2_1_1ParseXML_a903303a97ffb911574f691744978e7e5}{verbose} = verbose
35         self.\hyperlink{classex2_1_1ParseXML_a782928ec4f5e8e20237621fb7a9178b7}{dict} = defaultdict(list)
36 
37         \textcolor{keywordflow}{try}:  \textcolor{comment}{# to open the xml file with schema}
38             schema = self.\hyperlink{classex2_1_1ParseXML_a4895e49c1059c9aedd93f97c29eee30f}{readXSD}()
39             self.\hyperlink{classex2_1_1ParseXML_a5525ea8efb94c0fd12c9100b04702c5b}{readXML}(schema)
40             self.\hyperlink{classex2_1_1ParseXML_ad085ab1449b4ae5d51fef904d759c73b}{readAttributes}()
41             self.\hyperlink{classex2_1_1ParseXML_a87b2265b8dccd79ff09bd10ee2f8c269}{writeCSV}()
42         \textcolor{keywordflow}{except} (XMLSchemaParseError, XMLSyntaxError) \textcolor{keyword}{as} e:
43             \textcolor{comment}{# stream needs file object}
44             sys.stderr = open(\textcolor{stringliteral}{'err.log'}, \textcolor{stringliteral}{'w'})
45             sys.stderr.write(str(e))
46             \textcolor{comment}{# possible to get the data although not valid}
47             print(\textcolor{stringliteral}{"Encountered error (see err.log). Trying to continue anyway..."})
48             self.\hyperlink{classex2_1_1ParseXML_a5525ea8efb94c0fd12c9100b04702c5b}{readXML}()
49             self.\hyperlink{classex2_1_1ParseXML_ad085ab1449b4ae5d51fef904d759c73b}{readAttributes}()
50             self.\hyperlink{classex2_1_1ParseXML_a87b2265b8dccd79ff09bd10ee2f8c269}{writeCSV}()
51             \textcolor{comment}{# yesNo = input("Encountered error (see err.log). Continue anyway? [yn] ")}
52             \textcolor{comment}{# if yesNo == 'y':}
53             \textcolor{comment}{#     self.readXML()}
54             \textcolor{comment}{#     self.readAttributes()}
55             \textcolor{comment}{#     self.writeCSV()}
56             \textcolor{comment}{# else:}
57             \textcolor{comment}{#     sys.exit()}
58 
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}!read\+Attributes@{read\+Attributes}}
\index{read\+Attributes@{read\+Attributes}!ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}}
\subsubsection[{\texorpdfstring{read\+Attributes(self)}{readAttributes(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def ex2.\+Parse\+X\+M\+L.\+read\+Attributes (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classex2_1_1ParseXML_ad085ab1449b4ae5d51fef904d759c73b}{}\label{classex2_1_1ParseXML_ad085ab1449b4ae5d51fef904d759c73b}
\begin{DoxyVerb}Catch XML nodes and attributes.\end{DoxyVerb}
 

Definition at line 81 of file ex2.\+py.


\begin{DoxyCode}
81     \textcolor{keyword}{def }\hyperlink{classex2_1_1ParseXML_ad085ab1449b4ae5d51fef904d759c73b}{readAttributes}(self):
82         \textcolor{stringliteral}{"""Catch XML nodes and attributes."""}
83         nsmap = self.rootXML.nsmap
84         \textcolor{comment}{# gasDay - depth 0}
85         nodes = self.rootXML.find(\textcolor{stringliteral}{"\{"} + nsmap[\textcolor{keywordtype}{None}] + \textcolor{stringliteral}{"\}gasDay"})
86         self.\hyperlink{classex2_1_1ParseXML_a83d9af9a8df0ff6091822bccc1d6c236}{date} = nodes.get(\textcolor{stringliteral}{'date'})
87         startingHour = int(nodes.get(\textcolor{stringliteral}{'gasDayStartHourInUTC'}))
88         \textcolor{comment}{# boundaryNode - depth 1}
89         \textcolor{keywordflow}{for} node \textcolor{keywordflow}{in} nodes:
90             \textcolor{comment}{# time - depth 2}
91             \textcolor{keywordflow}{for} elem \textcolor{keywordflow}{in} node:
92                 \textcolor{comment}{# amountOfPower - depth 3}
93                 aop = elem.find(\textcolor{stringliteral}{"\{"} + nsmap[\textcolor{keywordtype}{None}] + \textcolor{stringliteral}{"\}amountOfPower"})
94                 \textcolor{comment}{# set id as dictionary key and tuple the hour + value}
95                 self.\hyperlink{classex2_1_1ParseXML_a782928ec4f5e8e20237621fb7a9178b7}{dict}[node.get(\textcolor{stringliteral}{'id'})].append((int(elem.get(\textcolor{stringliteral}{'hour'})) + startingHour, float(aop.get(\textcolor{stringliteral}{'
      value'}))))
96 
\end{DoxyCode}
\index{ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}!read\+X\+ML@{read\+X\+ML}}
\index{read\+X\+ML@{read\+X\+ML}!ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}}
\subsubsection[{\texorpdfstring{read\+X\+M\+L(self, schema=\+None)}{readXML(self, schema=None)}}]{\setlength{\rightskip}{0pt plus 5cm}def ex2.\+Parse\+X\+M\+L.\+read\+X\+ML (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{schema = {\ttfamily None}}
\end{DoxyParamCaption}
)}\hypertarget{classex2_1_1ParseXML_a5525ea8efb94c0fd12c9100b04702c5b}{}\label{classex2_1_1ParseXML_a5525ea8efb94c0fd12c9100b04702c5b}
\begin{DoxyVerb}Open XML file and return the root.

Parameters
----------
schema : validation with a schema is optional\end{DoxyVerb}
 

Definition at line 66 of file ex2.\+py.


\begin{DoxyCode}
66     \textcolor{keyword}{def }\hyperlink{classex2_1_1ParseXML_a5525ea8efb94c0fd12c9100b04702c5b}{readXML}(self, schema=None):
67         \textcolor{stringliteral}{"""}
68 \textcolor{stringliteral}{        Open XML file and return the root.}
69 \textcolor{stringliteral}{}
70 \textcolor{stringliteral}{        Parameters}
71 \textcolor{stringliteral}{        ----------}
72 \textcolor{stringliteral}{        schema : validation with a schema is optional}
73 \textcolor{stringliteral}{}
74 \textcolor{stringliteral}{        """}
75         parser = etree.XMLParser(remove\_comments=\textcolor{keyword}{True}, schema=schema)
76         \textcolor{comment}{# validation happens with the schema argument during parsing or throw}
77         \textcolor{comment}{# an error to see whats wrong (in init)}
78         tree = objectify.parse(self.\hyperlink{classex2_1_1ParseXML_ae06baa8c594f88a71490e8bafae1da37}{fileXML}, parser=parser)
79         self.\hyperlink{classex2_1_1ParseXML_aae05e41a6c40855aa4bc78a80ba1f2be}{rootXML} = tree.getroot()
80 
\end{DoxyCode}
\index{ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}!read\+X\+SD@{read\+X\+SD}}
\index{read\+X\+SD@{read\+X\+SD}!ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}}
\subsubsection[{\texorpdfstring{read\+X\+S\+D(self)}{readXSD(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def ex2.\+Parse\+X\+M\+L.\+read\+X\+SD (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classex2_1_1ParseXML_a4895e49c1059c9aedd93f97c29eee30f}{}\label{classex2_1_1ParseXML_a4895e49c1059c9aedd93f97c29eee30f}
\begin{DoxyVerb}Open a scheme file to validate the to-be-read file.\end{DoxyVerb}
 

Definition at line 59 of file ex2.\+py.


\begin{DoxyCode}
59     \textcolor{keyword}{def }\hyperlink{classex2_1_1ParseXML_a4895e49c1059c9aedd93f97c29eee30f}{readXSD}(self):
60         \textcolor{stringliteral}{"""Open a scheme file to validate the to-be-read file."""}
61         schema = etree.parse(self.\hyperlink{classex2_1_1ParseXML_a6075f0d21a2b394e7d6413347967b61e}{fileXSD})
62         \textcolor{keywordflow}{return} etree.XMLSchema(schema)
63         \textcolor{comment}{# only returns True or False}
64         \textcolor{comment}{# print(self.schema.validate(etree.parse(self.fileXML)))}
65 
\end{DoxyCode}
\index{ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}!write\+C\+SV@{write\+C\+SV}}
\index{write\+C\+SV@{write\+C\+SV}!ex2\+::\+Parse\+X\+ML@{ex2\+::\+Parse\+X\+ML}}
\subsubsection[{\texorpdfstring{write\+C\+S\+V(self)}{writeCSV(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def ex2.\+Parse\+X\+M\+L.\+write\+C\+SV (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classex2_1_1ParseXML_a87b2265b8dccd79ff09bd10ee2f8c269}{}\label{classex2_1_1ParseXML_a87b2265b8dccd79ff09bd10ee2f8c269}
\begin{DoxyVerb}Print data to csv.\end{DoxyVerb}
 

Definition at line 97 of file ex2.\+py.


\begin{DoxyCode}
97     \textcolor{keyword}{def }\hyperlink{classex2_1_1ParseXML_a87b2265b8dccd79ff09bd10ee2f8c269}{writeCSV}(self):
98         \textcolor{stringliteral}{"""Print data to csv."""}
99         fName = \textcolor{stringliteral}{'.'}.join(self.fileXML.split(\textcolor{stringliteral}{'/'})[1].split(\textcolor{stringliteral}{'.'})[:-1]) + \textcolor{stringliteral}{'.csv'}
100         with open(fName, \textcolor{stringliteral}{'w'}, newline=\textcolor{stringliteral}{''}) \textcolor{keyword}{as} out:
101             writer = csv.writer(out, delimiter=\textcolor{stringliteral}{';'}, lineterminator=\textcolor{stringliteral}{'\(\backslash\)n'})
102             \textcolor{comment}{# sort dictionary by key}
103             \textcolor{keywordflow}{for} key, vals \textcolor{keywordflow}{in} sorted(self.dict.items()):
104                 writer.writerow([\textcolor{stringliteral}{'# '} + key])
105                 \textcolor{keywordflow}{for} val \textcolor{keywordflow}{in} vals:
106                     writer.writerow([self.\hyperlink{classex2_1_1ParseXML_a83d9af9a8df0ff6091822bccc1d6c236}{date}, val[0], val[1]])
107 
108         \textcolor{keywordflow}{if} self.\hyperlink{classex2_1_1ParseXML_a903303a97ffb911574f691744978e7e5}{verbose}:
109             print(\textcolor{stringliteral}{"Saved as \{\}"}.format(fName), file=sys.stdout)
110 
111 
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/\+O\+P\+T\+I/bzfdinse/appfs/\+Dinsel/ex2/ex2.\+py\end{DoxyCompactItemize}
